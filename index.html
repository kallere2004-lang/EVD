<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
     <!-- 
    Web apps script

function doPost(e) {
  try {
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    var data = JSON.parse(e.postData.contents);
    
    // Append data into the sheet
    sheet.appendRow([data.name, data.score, new Date()]);
    
    return ContentService.createTextOutput("Saved Successfully!");
  } catch (err) {
    return ContentService.createTextOutput("Error: " + err.message);
  }
}

function doGet(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var values = sheet.getDataRange().getValues();
  return ContentService.createTextOutput(JSON.stringify(values))
                       .setMimeType(ContentService.MimeType.JSON);
}

     -->

   <body>
    <button id="saveBtn">Save Data</button>
    <button id="fetchBtn">Fetch Data</button>
    <div id="output"></div> <!-- New element to display the data -->

<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbwuPBfh12Op2sdPXpA_TjhrDVtc1H4-nkbLja3N_tfA5tdG1gD--DqIBwc58FBORXjM/exec"; // paste your Web App URL here

  document.getElementById("saveBtn").addEventListener("click", () => {
    const payload = { name: "John Doe", score: 95 };

    fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(payload)
    })
    .then(res => res.text())
    .then(msg => alert(msg))
    .catch(err => console.error("Error:", err));
  });

document.getElementById("fetchBtn").addEventListener("click", () => {
  fetch(scriptURL)
    .then(res => res.json())
    .then(data => {
      const outputDiv = document.getElementById("output");
      outputDiv.innerHTML = ""; // clear previous content

      data.forEach(row => {
        const [name, score, timestamp] = row;
        const item = document.createElement("p");
        item.textContent = `Name: ${name}, Score: ${score}, Time: ${timestamp}`;
        outputDiv.appendChild(item);
      });
    })
    .catch(err => {
      console.error("Error fetching data:", err);
    });
});




</script>
</body>
</html>
